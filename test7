local LocalPlayer = game.Players.LocalPlayer

local ReplicatedStorageService = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local BedwarsRemotes = {
	JoinQueueRemote = ReplicatedStorageService:WaitForChild("events-@easy-games/lobby:shared/event/lobby-events@getEvents.Events"):WaitForChild("joinQueue")
}

local ClientStore

task.spawn(function()
	local ClientStoreValue, Response = pcall(function()
		return require(LocalPlayer.PlayerScripts.TS.ui.store).ClientStore
	end)

	if ClientStoreValue == true and Response then
		ClientStore = require(LocalPlayer.PlayerScripts.TS.ui.store).ClientStore
	end
end)


local function JoinQueueWithDesiredType(QueueType)
	BedwarsRemotes.JoinQueueRemote:FireServer({queueType = QueueType})
end

local function StartServerTeleportation()
	local TeleportData = TeleportService:GetLocalPlayerTeleportData()

	TeleportService:Teleport(game.PlaceId, LocalPlayer, TeleportData)
end

local function GetMatchState()
	local Success, Response = pcall(function()
		return ClientStore:getState().Game.matchState
	end)
	
	if not ClientStore then
		return "UnSupported"
	end
	
	if Success == true and Response then
		return Response
	end
	
	if Success == false or not Response then
		return "Nil"
	end
end

task.spawn(function()
	local MatchState = GetMatchState()
	
	repeat
		task.wait()
		
		MatchState = GetMatchState()
		
		if MatchState == 2 then
			StartServerTeleportation()
		end
	until not game
end)

task.spawn(function()
	LocalPlayer.OnTeleport:Connect(function(TeleportState)
		if TeleportState == Enum.TeleportState.Started then
			queue_on_teleport('loadstring(game:HttpGet("https://raw.githubusercontent.com/AlSploit/AlSploit/refs/heads/main/test7"))()')
		end
	end)
end)
